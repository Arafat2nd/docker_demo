on:
  push:
    tags:
      - "**"

name: Release

jobs:
  release:
    name: Release
    runs-on: ubuntu-20.04
    env:
      DOCKER_REPO: saadmtsa/devops_docker_demo_palestine
    steps:
      - uses: actions/checkout@v2
      - name: Docker Login
        env:
          DOCKER_USERNAME: saadmtsa
          DOCKER_PASSWORD: ${{ secrets.DOCKERHUB_TOKEN }}
        run: |
          docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
      - name: Build Docker Image
        run: |
          version=${GITHUB_REF##*/}
          docker build . -t $DOCKER_REPO:$version
      - name: Push Docker Image
          version=${GITHUB_REF##*/}
          docker push $DOCKER_REPO:$version
